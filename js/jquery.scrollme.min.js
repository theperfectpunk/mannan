// ----------------------------------------------------------------------------------------------------
// ScrollMe
// A jQuery plugin for adding simple scrolling effects to web pages
// http://scrollme.nckprsn.com
// ----------------------------------------------------------------------------------------------------
var scrollme=function(n){var k={},e=n(document),t=n(window);return k.body_height=0,k.viewport_height=0,k.viewport_top=0,k.viewport_bottom=0,k.viewport_top_previous=-1,k.elements=[],k.elements_in_view=[],k.property_defaults={opacity:1,translatex:0,translatey:0,translatez:0,rotatex:0,rotatey:0,rotatez:0,scale:1,scalex:1,scaley:1,scalez:1},k.scrollme_selector=".scrollme",k.animateme_selector=".animateme",k.update_interval=10,k.easing_functions={linear:function(e){return e},easeout:function(e){return e*e*e},easein:function(e){return 1-(e=1-e)*e*e},easeinout:function(e){return e<.5?4*e*e*e:1-4*(e=1-e)*e*e}},k.init_events=["ready","page:load","page:change"],k.init_if=function(){return!0},k.init=function(){return!!k.init_if()&&(k.init_elements(),k.on_resize(),t.on("resize orientationchange",function(){k.on_resize()}),n(document).ready(function(){setTimeout(function(){k.on_resize()},100)}),setInterval(k.update,k.update_interval),!0)},k.init_elements=function(){n(k.scrollme_selector).each(function(){var e={};e.element=n(this);var a=[];n(this).find(k.animateme_selector).addBack(k.animateme_selector).each(function(){var e={};e.element=n(this),e.when=e.element.data("when"),e.from=e.element.data("from"),e.to=e.element.data("to"),e.element.is("[data-crop]")?e.crop=e.element.data("crop"):e.crop=!0,e.element.is("[data-easing]")?e.easing=k.easing_functions[e.element.data("easing")]:e.easing=k.easing_functions.easeout;var t={};e.element.is("[data-opacity]")&&(t.opacity=e.element.data("opacity")),e.element.is("[data-translatex]")&&(t.translatex=e.element.data("translatex")),e.element.is("[data-translatey]")&&(t.translatey=e.element.data("translatey")),e.element.is("[data-translatez]")&&(t.translatez=e.element.data("translatez")),e.element.is("[data-rotatex]")&&(t.rotatex=e.element.data("rotatex")),e.element.is("[data-rotatey]")&&(t.rotatey=e.element.data("rotatey")),e.element.is("[data-rotatez]")&&(t.rotatez=e.element.data("rotatez")),e.element.is("[data-scale]")&&(t.scale=e.element.data("scale")),e.element.is("[data-scalex]")&&(t.scalex=e.element.data("scalex")),e.element.is("[data-scaley]")&&(t.scaley=e.element.data("scaley")),e.element.is("[data-scalez]")&&(t.scalez=e.element.data("scalez")),e.properties=t,a.push(e)}),e.effects=a,k.elements.push(e)})},k.update=function(){window.requestAnimationFrame(function(){k.update_viewport_position(),k.viewport_top_previous!=k.viewport_top&&(k.update_elements_in_view(),k.animate()),k.viewport_top_previous=k.viewport_top})},k.animate=function(){for(var e=k.elements_in_view.length,t=0;t<e;t++)for(var a=k.elements_in_view[t],n=a.effects.length,i=0;i<n;i++){var o=a.effects[i];switch(o.when){case"view":case"span":var r=a.top-k.viewport_height,s=a.bottom;break;case"exit":r=a.bottom-k.viewport_height,s=a.bottom;break;default:r=a.top-k.viewport_height,s=a.top}o.crop&&(r<0&&(r=0),s>k.body_height-k.viewport_height&&(s=k.body_height-k.viewport_height));var l=(k.viewport_top-r)/(s-r),m=o.from,p=o.to,c=(l-m)/(p-m),_=o.easing(c),u=k.animate_value(l,_,m,p,o,"opacity"),d=k.animate_value(l,_,m,p,o,"translatey"),v=k.animate_value(l,_,m,p,o,"translatex"),h=k.animate_value(l,_,m,p,o,"translatez"),f=k.animate_value(l,_,m,p,o,"rotatex"),w=k.animate_value(l,_,m,p,o,"rotatey"),g=k.animate_value(l,_,m,p,o,"rotatez"),y=k.animate_value(l,_,m,p,o,"scale"),x=k.animate_value(l,_,m,p,o,"scalex"),z=k.animate_value(l,_,m,p,o,"scaley"),b=k.animate_value(l,_,m,p,o,"scalez");"scale"in o.properties&&(b=z=x=y),o.element.css({opacity:u,transform:"translate3d( "+v+"px , "+d+"px , "+h+"px ) rotateX( "+f+"deg ) rotateY( "+w+"deg ) rotateZ( "+g+"deg ) scale3d( "+x+" , "+z+" , "+b+" )"})}},k.animate_value=function(e,t,a,n,i,o){var r=k.property_defaults[o];if(!(o in i.properties))return r;var s=i.properties[o],l=a<n;if(e<a&&l)return r;if(n<e&&l)return s;if(a<e&&!l)return r;if(e<n&&!l)return s;var m=r+t*(s-r);switch(o){case"opacity":m=m.toFixed(2);break;case"translatex":case"translatey":case"translatez":m=m.toFixed(0);break;case"rotatex":case"rotatey":case"rotatez":m=m.toFixed(1);break;case"scale":m=m.toFixed(3)}return m},k.update_viewport_position=function(){k.viewport_top=t.scrollTop(),k.viewport_bottom=k.viewport_top+k.viewport_height},k.update_elements_in_view=function(){k.elements_in_view=[];for(var e=k.elements.length,t=0;t<e;t++)k.elements[t].top<k.viewport_bottom&&k.elements[t].bottom>k.viewport_top&&k.elements_in_view.push(k.elements[t])},k.on_resize=function(){k.update_viewport(),k.update_element_heights(),k.update_viewport_position(),k.update_elements_in_view(),k.animate()},k.update_viewport=function(){k.body_height=e.height(),k.viewport_height=t.height()},k.update_element_heights=function(){for(var e=k.elements.length,t=0;t<e;t++){var a=k.elements[t].element.outerHeight(),n=k.elements[t].element.offset();k.elements[t].height=a,k.elements[t].top=n.top,k.elements[t].bottom=n.top+a}},n("document").ready(function(){k.init()}),k}(jQuery);
